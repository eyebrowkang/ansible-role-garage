# Managed by Ansible
# https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/

replication_factor = {{ garage_replication_factor }}

metadata_dir = "{{ garage_metadata_dir }}"
data_dir = "{{ garage_data_dir }}"

db_engine = "{{ garage_db_engine }}"

rpc_secret = "{{ garage_rpc_secret }}"
rpc_bind_addr = "{{ garage_rpc_bind_addr }}"
rpc_public_addr = "{{ garage_rpc_public_addr }}"
{% if garage_bootstrap_peers | default([]) | length > 0 %}

bootstrap_peers = {{ garage_bootstrap_peers | to_json }}
{% endif %}

[s3_api]
api_bind_addr = "{{ garage_s3_api_bind_addr }}"
s3_region = "{{ garage_s3_region }}"
root_domain = "{{ garage_s3_root_domain }}"

[s3_web]
bind_addr = "{{ garage_s3_web_bind_addr }}"
root_domain = "{{ garage_s3_web_root_domain }}"

[admin]
api_bind_addr = "{{ garage_admin_api_bind_addr }}"
{% if garage_admin_token | default('') | length > 0 %}
admin_token = "{{ garage_admin_token }}"
{% endif %}
{% if garage_metrics_token | default('') | length > 0 %}
metrics_token = "{{ garage_metrics_token }}"
{% endif %}
{% set _custom_options = garage_config_custom_options | default('') %}
{% if _custom_options | trim | length > 0 %}
{{ _custom_options }}
{% endif %}
